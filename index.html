<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Groove Browser</title>
    <style>
        /* --- CORE DESIGN SYSTEM --- */
        :root {
            --bg-dark: #09090b;
            --bg-gradient: radial-gradient(circle at 50% 0%, #1c1c2e, #09090b 55%);
            
            /* Glassmorphism Variables */
            --glass-surface: rgba(20, 20, 28, 0.75);
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-highlight: rgba(255, 255, 255, 0.15);
            --glass-blur: blur(24px);
            
            /* Colors */
            --accent: #5e81ac;
            --accent-glow: rgba(94, 129, 172, 0.4);
            --success: #a3be8c;
            --danger: #bf616a;
            --text-primary: #eceff4;
            --text-secondary: #9fa6b2;
            
            /* Metrics */
            --radius-xl: 28px;
            --radius-lg: 18px;
            --nav-height: 64px;
            --anim-ease: cubic-bezier(0.22, 1, 0.36, 1);
        }

        /* --- RESET --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; }
        
        body {
            margin: 0; padding: 0;
            background: var(--bg-dark);
            background-image: var(--bg-gradient);
            color: var(--text-primary);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            height: 100vh;
            overflow: hidden;
            display: flex; flex-direction: column;
        }

        /* --- UTILITY CLASSES --- */
        .glass {
            background: var(--glass-surface);
            backdrop-filter: var(--glass-blur);
            -webkit-backdrop-filter: var(--glass-blur);
            border: 1px solid var(--glass-border);
        }
        
        .fade-enter { animation: fadeIn 0.4s var(--anim-ease) forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }

        /* --- SPLASH SCREEN --- */
        #splash {
            position: fixed; inset: 0; z-index: 9999;
            background: var(--bg-dark);
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            transition: opacity 0.6s ease;
        }
        .splash-ring {
            width: 60px; height: 60px; border-radius: 50%;
            border: 3px solid transparent; border-top-color: var(--accent); border-right-color: var(--accent);
            animation: spin 1s linear infinite; margin-bottom: 20px;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* --- TOP ADDRESS BAR --- */
        header {
            height: var(--nav-height);
            padding: 8px 12px;
            display: flex; align-items: center; gap: 10px;
            z-index: 100;
        }

        .omnibar {
            flex: 1; height: 46px;
            border-radius: var(--radius-xl);
            display: flex; align-items: center;
            padding: 0 16px;
            position: relative;
            overflow: hidden;
            transition: box-shadow 0.3s var(--anim-ease);
        }
        
        .omnibar:focus-within {
            border-color: var(--accent);
            box-shadow: 0 0 0 2px var(--accent-glow);
            background: rgba(255,255,255,0.08);
        }

        #security-indicator {
            width: 12px; height: 12px; border-radius: 50%;
            background: var(--text-secondary); margin-right: 10px;
            transition: background 0.3s;
            box-shadow: 0 0 8px transparent;
        }
        #security-indicator.secure { background: var(--success); box-shadow: 0 0 8px rgba(163, 190, 140, 0.4); }
        #security-indicator.insecure { background: var(--danger); }

        #url-input {
            flex: 1; background: transparent; border: none;
            color: var(--text-primary); font-size: 15px; font-weight: 500;
            width: 100%; height: 100%;
        }
        #url-input::placeholder { color: rgba(255,255,255,0.2); }

        /* Loading Bar */
        #loader {
            position: absolute; bottom: 0; left: 0; height: 2px; width: 0%;
            background: var(--accent);
            box-shadow: 0 0 10px var(--accent);
            transition: width 0.2s ease, opacity 0.3s;
        }

        /* --- MAIN VIEWPORT --- */
        #viewport {
            flex: 1; position: relative;
            margin: 0 10px;
            border-radius: var(--radius-lg);
            overflow: hidden;
            background: #fff; /* Web content standard bg */
            transition: transform 0.3s var(--anim-ease);
        }
        
        iframe {
            width: 100%; height: 100%; border: none; display: block;
        }

        /* --- HOME / NEW TAB --- */
        #home {
            position: absolute; inset: 0;
            background: var(--bg-dark);
            background-image: radial-gradient(circle at 50% 50%, #151520, #000);
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            z-index: 50;
        }
        
        .brand { font-size: 42px; font-weight: 800; letter-spacing: -2px; margin-bottom: 40px; background: linear-gradient(to right, #fff, #888); -webkit-background-clip: text; -webkit-text-fill-color: transparent;}
        
        .shield-grid {
            display: grid; grid-template-columns: repeat(3, 1fr);
            gap: 12px; width: 90%; max-width: 360px;
        }
        
        .shield-card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 16px; padding: 16px 8px;
            text-align: center;
        }
        .shield-val { font-size: 22px; font-weight: 700; color: var(--accent); display: block; }
        .shield-lbl { font-size: 10px; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 1px; margin-top: 6px; }

        /* --- BOTTOM NAV --- */
        nav {
            height: 70px; padding: 0 24px;
            display: flex; justify-content: space-between; align-items: center;
            border-top: 1px solid var(--glass-border);
            z-index: 100;
        }

        .nav-btn {
            width: 48px; height: 48px; border-radius: 50%;
            background: transparent; border: none;
            color: var(--text-primary);
            display: grid; place-items: center;
            cursor: pointer; transition: 0.2s;
        }
        .nav-btn:active { background: rgba(255,255,255,0.1); transform: scale(0.9); }
        .nav-btn svg { width: 22px; height: 22px; fill: currentColor; }

        /* --- SETTINGS SHEET --- */
        #overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.6);
            backdrop-filter: blur(4px); z-index: 200;
            opacity: 0; pointer-events: none; transition: opacity 0.3s;
            display: flex; align-items: flex-end;
        }
        #overlay.active { opacity: 1; pointer-events: auto; }

        #sheet {
            width: 100%; background: #13131a;
            border-top: 1px solid var(--glass-highlight);
            border-radius: 24px 24px 0 0;
            padding: 24px;
            transform: translateY(100%);
            transition: transform 0.35s cubic-bezier(0.175, 0.885, 0.32, 1.1); /* Springy */
            max-height: 80vh; overflow-y: auto;
        }
        #overlay.active #sheet { transform: translateY(0); }

        .sheet-drag { width: 32px; height: 4px; background: rgba(255,255,255,0.2); border-radius: 2px; margin: 0 auto 24px; }

        .setting-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 16px 0; border-bottom: 1px solid rgba(255,255,255,0.04);
        }
        .st-txt h4 { margin: 0 0 4px; font-size: 15px; }
        .st-txt p { margin: 0; font-size: 12px; color: var(--text-secondary); }

        /* Toggle Switch */
        .switch {
            width: 46px; height: 26px; background: rgba(255,255,255,0.15);
            border-radius: 13px; position: relative; transition: 0.3s;
        }
        .switch::after {
            content:''; position: absolute; top: 3px; left: 3px;
            width: 20px; height: 20px; background: #fff; border-radius: 50%;
            transition: transform 0.3s var(--anim-ease);
        }
        .switch.on { background: var(--success); }
        .switch.on::after { transform: translateX(20px); }

        /* --- TOAST --- */
        #toast {
            position: fixed; top: 90px; left: 50%; transform: translate(-50%, -20px);
            background: rgba(30,30,30,0.9); backdrop-filter: blur(10px);
            padding: 10px 20px; border-radius: 30px;
            font-size: 13px; opacity: 0; pointer-events: none;
            transition: 0.3s var(--anim-ease); z-index: 500;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            border: 1px solid rgba(255,255,255,0.1);
        }
        #toast.vis { transform: translate(-50%, 0); opacity: 1; }

        /* --- INSPECT OVERLAY --- */
        #inspect {
            position: absolute; inset: 0; background: #000; color: #0f0;
            font-family: 'Courier New', monospace; padding: 20px;
            z-index: 600; display: none; overflow: auto;
        }
        .json-block { background: #111; padding: 10px; border-radius: 8px; font-size: 11px; margin-bottom: 10px; word-wrap: break-word; }

    </style>
</head>
<body>

    <div id="splash">
        <div class="splash-ring"></div>
        <div style="letter-spacing:4px; font-size:14px; color:var(--text-secondary);">GROOVE</div>
    </div>

    <header class="glass">
        <div class="omnibar glass">
            <div id="security-indicator"></div>
            <input type="text" id="url-input" placeholder="Search or Type URL" autocomplete="off" spellcheck="false">
            <div id="loader"></div>
        </div>
    </header>

    <div id="viewport">
        <div id="home">
            <div class="brand">Groove</div>
            <div class="shield-grid">
                <div class="shield-card">
                    <span class="shield-val" id="cnt-ads">0</span>
                    <span class="shield-lbl">Blocked</span>
                </div>
                <div class="shield-card">
                    <span class="shield-val" id="cnt-track">0</span>
                    <span class="shield-lbl">Trackers</span>
                </div>
                <div class="shield-card">
                    <span class="shield-val" id="cnt-sec">0</span>
                    <span class="shield-lbl">HTTPS</span>
                </div>
            </div>
            <div style="margin-top: 30px; display: flex; gap: 10px;">
                <button onclick="nav('https://duckduckgo.com')" style="padding: 8px 16px; border-radius: 20px; border: 1px solid #333; background: transparent; color: #888;">DuckDuckGo</button>
                <button onclick="nav('https://google.com')" style="padding: 8px 16px; border-radius: 20px; border: 1px solid #333; background: transparent; color: #888;">Google</button>
            </div>
        </div>
        <iframe id="browser-frame" sandbox="allow-scripts allow-same-origin allow-forms allow-popups"></iframe>
        <div id="inspect"></div>
    </div>

    <nav class="glass">
        <button class="nav-btn" id="btn-back"><svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg></button>
        <button class="nav-btn" id="btn-forward"><svg viewBox="0 0 24 24"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg></button>
        <button class="nav-btn" id="btn-home" style="background: var(--accent); color: #fff; box-shadow: 0 4px 12px var(--accent-glow);"><svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg></button>
        <button class="nav-btn" id="btn-reload"><svg viewBox="0 0 24 24"><path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg></button>
        <button class="nav-btn" id="btn-menu"><svg viewBox="0 0 24 24"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></button>
    </nav>

    <div id="overlay">
        <div id="sheet">
            <div class="sheet-drag"></div>
            <h3 style="color:var(--text-primary); margin-bottom: 20px;">Groove Shield</h3>
            
            <div class="setting-item">
                <div class="st-txt">
                    <h4>Block Ads</h4>
                    <p>Aggressive filtering</p>
                </div>
                <div class="switch on" id="tog-ads"></div>
            </div>

            <div class="setting-item">
                <div class="st-txt">
                    <h4>Block Trackers</h4>
                    <p>Prevent cross-site tracking</p>
                </div>
                <div class="switch on" id="tog-track"></div>
            </div>

            <div class="setting-item">
                <div class="st-txt">
                    <h4>JavaScript</h4>
                    <p>Toggle execution (Global)</p>
                </div>
                <div class="switch on" id="tog-js"></div>
            </div>

            <div class="setting-item">
                <div class="st-txt">
                    <h4>Default Search</h4>
                    <p id="engine-lbl">DuckDuckGo</p>
                </div>
                <button id="cycle-engine" style="background:#333; border:none; color:#fff; padding:6px 12px; border-radius:8px;">Change</button>
            </div>

            <div style="margin-top:20px; display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                 <button id="act-clear" style="background:var(--danger); border:none; color:#fff; padding:12px; border-radius:12px;">Clear Data</button>
                 <button id="act-share" style="background:rgba(255,255,255,0.1); border:none; color:#fff; padding:12px; border-radius:12px;">Share URL</button>
            </div>
        </div>
    </div>

    <div id="toast">Notification</div>

    <script>
        // --- GROOVE ENGINE ---
        const $ = (id) => document.getElementById(id);
        
        const state = {
            hist: [],
            idx: -1,
            stats: {
                ads: parseInt(localStorage.getItem('g_ads')||0),
                track: parseInt(localStorage.getItem('g_track')||0),
                sec: parseInt(localStorage.getItem('g_sec')||0)
            },
            config: {
                ads: true,
                track: true,
                js: true,
                engine: localStorage.getItem('g_eng') || 'ddg'
            }
        };

        const engines = {
            ddg: { n: 'DuckDuckGo', u: 'https://duckduckgo.com/?q=' },
            google: { n: 'Google', u: 'https://www.google.com/search?q=' },
            bing: { n: 'Bing', u: 'https://www.bing.com/search?q=' },
            yandex: { n: 'Yandex', u: 'https://yandex.com/search/?text=' }
        };

        // --- INIT ---
        window.onload = () => {
            updateStats();
            $('engine-lbl').innerText = engines[state.config.engine].n;
            
            // Fade out splash
            setTimeout(() => {
                $('splash').style.opacity = 0;
                setTimeout(() => $('splash').style.display = 'none', 600);
            }, 1000);
        };

        // --- CORE NAVIGATION ---
        const nav = (raw) => {
            // Handle Internal
            if (raw.startsWith('groove://')) {
                handleScheme(raw);
                return;
            }

            let url = raw.trim();
            const isUrl = /^(http|https):\/\/[^ "]+$/.test(url) || /^[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/i.test(url);
            
            if (!isUrl) {
                // Search
                url = engines[state.config.engine].u + encodeURIComponent(raw);
            } else if (!url.startsWith('http')) {
                url = 'https://' + url;
            }

            load(url);
        };

        const load = (url) => {
            $('home').style.display = 'none';
            $('inspect').style.display = 'none';
            $('browser-frame').style.display = 'block';
            
            // Loading Animation
            $('loader').style.width = '70%';
            $('loader').style.opacity = '1';

            // Simulate Security Check
            if (url.startsWith('https')) {
                $('security-indicator').className = 'secure';
                increment('sec');
            } else {
                $('security-indicator').className = 'insecure';
                toast('âš ï¸ Connection Not Secure');
            }

            // Simulate AdBlock
            if (state.config.ads) {
                const blocked = Math.floor(Math.random() * 4); // Sim
                if(blocked > 0) {
                    increment('ads', blocked);
                    setTimeout(() => toast(`ðŸ›¡ï¸ Groove Shield: ${blocked} Ads blocked`), 1500);
                }
            }

            // Sandbox Logic
            const sandbox = state.config.js 
                ? "allow-scripts allow-same-origin allow-forms allow-popups" 
                : "allow-forms allow-popups";
            $('browser-frame').setAttribute('sandbox', sandbox);

            // Navigate
            $('browser-frame').src = url;
            $('url-input').value = url;
            
            // History
            if (state.hist[state.idx] !== url) {
                state.idx++;
                state.hist = state.hist.slice(0, state.idx);
                state.hist.push(url);
            }
            updateNav();

            // Finish Load
            setTimeout(() => {
                $('loader').style.width = '100%';
                setTimeout(() => {
                    $('loader').style.opacity = '0';
                    $('loader').style.width = '0';
                }, 300);
            }, 1200);
        };

        const handleScheme = (uri) => {
            $('home').style.display = 'none';
            $('browser-frame').style.display = 'none';
            $('inspect').style.display = 'none';
            $('url-input').value = uri;

            if (uri === 'groove://settings') {
                $('overlay').classList.add('active');
            } else if (uri === 'groove://inspect') {
                $('inspect').style.display = 'block';
                $('inspect').innerHTML = `
                    <h2 style="color:var(--accent)">Groove Inspector</h2>
                    <div class="json-block">URL: ${state.hist[state.idx] || 'Home'}</div>
                    <div class="json-block"><strong>Config:</strong><br>${JSON.stringify(state.config)}</div>
                    <div class="json-block"><strong>Stats:</strong><br>${JSON.stringify(state.stats)}</div>
                    <div class="json-block"><strong>History:</strong><br>${JSON.stringify(state.hist)}</div>
                `;
            }
        }

        // --- UI LOGIC ---
        $('url-input').addEventListener('keypress', (e) => {
            if(e.key === 'Enter') {
                $('url-input').blur();
                nav($('url-input').value);
            }
        });

        $('btn-back').onclick = () => {
            if(state.idx > 0) {
                state.idx--;
                load(state.hist[state.idx]);
            }
        };
        $('btn-forward').onclick = () => {
            if(state.idx < state.hist.length - 1) {
                state.idx++;
                load(state.hist[state.idx]);
            }
        };
        $('btn-reload').onclick = () => $('browser-frame').src += '';
        $('btn-home').onclick = () => {
            $('home').style.display = 'flex';
            $('browser-frame').style.display = 'none';
            $('inspect').style.display = 'none';
            $('url-input').value = '';
            $('security-indicator').className = '';
        };

        // --- MENU & SETTINGS ---
        $('btn-menu').onclick = () => $('overlay').classList.add('active');
        $('overlay').onclick = (e) => { if(e.target === $('overlay')) $('overlay').classList.remove('active'); };
        $('.sheet-drag').onclick = () => $('overlay').classList.remove('active');

        const toggle = (id, key) => {
            state.config[key] = !state.config[key];
            $(id).classList.toggle('on');
            toast(`${key.toUpperCase()} ${state.config[key] ? 'Enabled' : 'Disabled'}`);
        };

        $('tog-ads').onclick = () => toggle('tog-ads', 'ads');
        $('tog-track').onclick = () => toggle('tog-track', 'track');
        $('tog-js').onclick = () => toggle('tog-js', 'js');

        $('cycle-engine').onclick = () => {
            const keys = Object.keys(engines);
            let curr = keys.indexOf(state.config.engine);
            let next = keys[(curr + 1) % keys.length];
            state.config.engine = next;
            localStorage.setItem('g_eng', next);
            $('engine-lbl').innerText = engines[next].n;
            toast(`Search: ${engines[next].n}`);
        };

        $('act-clear').onclick = () => {
            localStorage.clear();
            location.reload();
        };
        
        $('act-share').onclick = () => {
            const url = $('url-input').value || 'https://groove.browser';
            navigator.clipboard.writeText(url);
            toast("URL Copied to Clipboard");
            $('overlay').classList.remove('active');
        };

        // --- HELPERS ---
        function increment(key, val=1) {
            state.stats[key] += val;
            localStorage.setItem('g_'+key, state.stats[key]);
            updateStats();
        }
        function updateStats() {
            $('cnt-ads').innerText = state.stats.ads;
            $('cnt-track').innerText = state.stats.track;
            $('cnt-sec').innerText = state.stats.sec;
        }
        function updateNav() {
            $('btn-back').style.opacity = state.idx > 0 ? 1 : 0.3;
            $('btn-forward').style.opacity = state.idx < state.hist.length-1 ? 1 : 0.3;
        }
        function toast(msg) {
            $('toast').innerText = msg;
            $('toast').classList.add('vis');
            setTimeout(() => $('toast').classList.remove('vis'), 3000);
        }
    </script>
</body>
</html>
